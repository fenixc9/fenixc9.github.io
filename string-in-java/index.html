<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Microsoft YaHei:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fenixc9.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":10,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":false,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"gitalk":{"order":-2}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="java.lang.Stringï¼Œå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨åˆ°çš„ç±»ä¹‹ä¸€ã€‚ç”±äºå®ƒå®åœ¨è¿‡äºå¸¸ç”¨ï¼Œä½ çš„ä»£ç ï¼Œä½ ä¾èµ–çš„åº“çš„ä»£ç ï¼Œjdkçš„ä»£ç ï¼Œç”šè‡³jvmè‡ªèº«éƒ½å’ŒStringæ¯æ¯ç›¸å…³ã€‚Stringçš„å®ç°çš„ä¼˜åŠ£ï¼Œå¯¹JVMçš„ç¨³å®šï¼Œå¯¹Javaçš„æ€§èƒ½ï¼Œä»¥åŠç¨‹åºå‘˜çš„ä½¿ç”¨ä½“éªŒå½±å“å¾ˆæ·±ã€‚æœ¬æ–‡å°†æ¢è®¨Java stringçš„ä¸€äº›ç»†èŠ‚åŠæˆ‘ä»¬å¼€å‘ä¸­å¯èƒ½ä¼šè¸©åˆ°çš„å‘ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="æ·±å…¥ç†è§£Javaçš„å­—ç¬¦ä¸²">
<meta property="og:url" content="https://fenixc9.github.io/string-in-java/index.html">
<meta property="og:site_name" content="ByteDrift">
<meta property="og:description" content="java.lang.Stringï¼Œå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨åˆ°çš„ç±»ä¹‹ä¸€ã€‚ç”±äºå®ƒå®åœ¨è¿‡äºå¸¸ç”¨ï¼Œä½ çš„ä»£ç ï¼Œä½ ä¾èµ–çš„åº“çš„ä»£ç ï¼Œjdkçš„ä»£ç ï¼Œç”šè‡³jvmè‡ªèº«éƒ½å’ŒStringæ¯æ¯ç›¸å…³ã€‚Stringçš„å®ç°çš„ä¼˜åŠ£ï¼Œå¯¹JVMçš„ç¨³å®šï¼Œå¯¹Javaçš„æ€§èƒ½ï¼Œä»¥åŠç¨‹åºå‘˜çš„ä½¿ç”¨ä½“éªŒå½±å“å¾ˆæ·±ã€‚æœ¬æ–‡å°†æ¢è®¨Java stringçš„ä¸€äº›ç»†èŠ‚åŠæˆ‘ä»¬å¼€å‘ä¸­å¯èƒ½ä¼šè¸©åˆ°çš„å‘ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fenixc9.github.io/string-in-java/1.webp">
<meta property="og:image" content="https://fenixc9.github.io/string-in-java/2.webp">
<meta property="og:image" content="https://fenixc9.github.io/string-in-java/3.webp">
<meta property="article:published_time" content="2023-02-21T17:37:47.000Z">
<meta property="article:modified_time" content="2025-04-05T03:45:29.198Z">
<meta property="article:author" content="fenix">
<meta property="article:tag" content="æ•°æ®ç»“æ„">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fenixc9.github.io/string-in-java/1.webp">

<link rel="canonical" href="https://fenixc9.github.io/string-in-java/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>æ·±å…¥ç†è§£Javaçš„å­—ç¬¦ä¸² | ByteDrift</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ByteDrift</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://fenixc9.github.io/string-in-java/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a.jpeg">
      <meta itemprop="name" content="fenix">
      <meta itemprop="description" content="ç¨‹åºå‘˜ï¼Œæ— å¯æ•‘è¯çš„ç†æƒ³ä¸»ä¹‰è€…">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ByteDrift">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          æ·±å…¥ç†è§£Javaçš„å­—ç¬¦ä¸²
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-02-22 01:37:47" itemprop="dateCreated datePublished" datetime="2023-02-22T01:37:47+08:00">2023-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-04-05 11:45:29" itemprop="dateModified" datetime="2025-04-05T11:45:29+08:00">2025-04-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
            <div class="post-description">java.lang.Stringï¼Œå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨åˆ°çš„ç±»ä¹‹ä¸€ã€‚ç”±äºå®ƒå®åœ¨è¿‡äºå¸¸ç”¨ï¼Œä½ çš„ä»£ç ï¼Œä½ ä¾èµ–çš„åº“çš„ä»£ç ï¼Œjdkçš„ä»£ç ï¼Œç”šè‡³jvmè‡ªèº«éƒ½å’ŒStringæ¯æ¯ç›¸å…³ã€‚Stringçš„å®ç°çš„ä¼˜åŠ£ï¼Œå¯¹JVMçš„ç¨³å®šï¼Œå¯¹Javaçš„æ€§èƒ½ï¼Œä»¥åŠç¨‹åºå‘˜çš„ä½¿ç”¨ä½“éªŒå½±å“å¾ˆæ·±ã€‚æœ¬æ–‡å°†æ¢è®¨Java stringçš„ä¸€äº›ç»†èŠ‚åŠæˆ‘ä»¬å¼€å‘ä¸­å¯èƒ½ä¼šè¸©åˆ°çš„å‘ã€‚</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="ç¼–ç "><a href="#ç¼–ç " class="headerlink" title="ç¼–ç "></a>ç¼–ç </h1><p>Java8åŠä¹‹å‰çš„Stringä¿å­˜çš„æ–¹æ³•æ˜¯è¿™æ ·çš„:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">String</span></span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">java</span>.io.Serializable, Comparable&lt;String&gt;, CharSequence &#123;</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">char</span> value[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨é‡Šä¸­è¿™æ ·æè¿°ï¼š</p>
<p>A String represents a string in the UTF-16 format in which supplementary characters are represented by surrogate pairs (see the section Unicode Character Representations in the Character class for more information). Index values refer to char code units, so a supplementary character uses two positions in a Stringã€‚</p>
<p>å³Javaä½¿ç”¨UTF16ç¼–ç æ„å»ºStringï¼Œå¯¹äºæ‰©å±•å­—ç¬¦ï¼ŒStringå°†ä½¿ç”¨2ä¸ªcharè¿™éå¸¸å¥½éªŒè¯:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> <span class="string">&quot;ğŸ&quot;</span>;</span><br><span class="line">        System.out.println(a.length());</span><br><span class="line">        System.out.println(a.codePoints().count());</span><br><span class="line">    &#125;</span><br><span class="line">è¾“å‡º</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span> </span><br></pre></td></tr></table></figure>

<p>ä¸Šä¾‹å¯çŸ¥ï¼Œå¯¹äºæƒ³è¦è·å–å­—ç¬¦ä¸²é•¿åº¦çš„åœºæ™¯ï¼Œå¦‚æœå­˜åœ¨æ‰©å±•å­—ç¬¦çš„æƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨length()ï¼Œå°†å¾—åˆ°é”™è¯¯çš„ç»“æœã€‚æƒ³è¦å¾—åˆ°æ­£ç¡®çš„ç»“æœåº”ä½¿ç”¨codePoint().count(),è¿™ä¸ªæ–¹æ³•å°†æ˜¯o(n)å¤æ‚åº¦äº†ã€‚å¯¹äºéœ€è¦ä¼°ç®—Stringå ç”¨ç©ºé—´çš„åœºåˆæ¥è¯´ï¼Œlengthä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¯¹äºéœ€è¦çœŸæ­£è®¡ç®—å­—ç¬¦ä¸ªæ•°çš„æƒ…å†µï¼Œæ¯”å¦‚é€ ä¸ªå¯Œæ–‡æœ¬æ¡†çš„è½®å­æ—¶ï¼Œlengthå°†å¯¼è‡´é—®é¢˜ã€‚</p>
<p>åŒç†è¿˜æœ‰charAtä¹Ÿä¸èƒ½å¾—åˆ°æ­£ç¡®çš„ç»“æœ :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">b</span> <span class="operator">=</span> <span class="string">&quot;ğŸqğŸ&quot;</span>;</span><br><span class="line">System.out.println(b.charAt(<span class="number">1</span>));</span><br><span class="line">è¾“å‡º ? </span><br></pre></td></tr></table></figure>
<p>é‚£codePointAtå¯ä»¥éšæœºè®¿é—®å—ï¼Œä»æ³¨é‡Šæ¥çœ‹è¿™é‡Œè¿”å›çš„æ˜¯unicodeå•å…ƒï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">System.out.println((<span class="type">char</span>) b.codePointAt(<span class="number">1</span>));</span><br><span class="line">System.out.println((<span class="type">char</span>) b.codePointAt(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line">?</span><br><span class="line">q </span><br></pre></td></tr></table></figure>

<p>ä»å­—ç¬¦æ¥çœ‹qæ˜¯ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ç”¨1è®¿é—®æ˜¯ï¼Ÿï¼Œæˆ‘ä»¬è®¿é—®ç¬¬ä¸‰ä¸ªå­—ç¬¦ï¼Œç”¨2è®¿é—®æ‰æ˜¯qã€‚æ€»ä¹‹åœ¨å­˜åœ¨æ‰©å±•å­—ç¬¦çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ä¸éå†çš„å‰æä¸‹å®šä½åˆ°è‡ªå·±éœ€è¦çš„å­—ç¬¦ï¼Œæ— æ³•åœ¨ o(1) å¤æ‚åº¦ä¸‹éšæœºè®¿é—®å­—ç¬¦ã€‚</p>
<p>å½“ç„¶ï¼Œæ–°å‹çš„è¯­è¨€å¤§å¤šç”¨utf8å­˜å‚¨å­—ç¬¦ä¸²äº†ï¼ˆGoï¼ŒRustï¼‰ï¼ŒJavaï¼ŒC#ï¼Œpythonï¼ˆ3.3ä¹‹å‰ï¼‰çš„åšæ³•å›ºç„¶æœ‰ä¸€äº›å†å²å±€é™æ€§å’Œå¦¥åï¼Œå°¤å…¶æ˜¯åœ¨asciiä¸ºä¸»çš„å­—ç¬¦ä¸²åœºæ™¯ä¸‹ï¼Œutf16å­˜å‚¨æ•ˆç‡è¿˜æ˜¯å¤ªä½äº†ã€‚å¾ˆå¤šè¾ƒè€çš„å®ç°å€¾å‘äºä»¥ç‰ºç‰²ç©ºé—´å’Œä¸€å®šç¨‹åº¦ä¸Šæ‰©å±•å­—ç¬¦çš„å…¼å®¹æ€§æ¥æ¢å–é«˜é€Ÿéšæœºè®¿é—®å­—ç¬¦ã€‚ä¸è¿‡åœ¨ä»¥asciiä¸ºä¸»çš„webå¤§è¡Œå…¶é“çš„å½“ä¸‹,ä»¥åŠè¶Šæ¥è¶Šå¤šçš„è¯­è¨€å­—ç¬¦,ä»¥åŠemojiåŠ å…¥åŒå­—èŠ‚Unicodeè¶Šæ¥è¶Šéš¾ä»¥æ»¡è¶³å…¼å®¹æ€§éœ€æ±‚,äººä»¬æ‰ä¼šå€¾å‘äºé€‰æ‹©utf8ä¸ºé»˜è®¤å­—ç¬¦ä¸²å®ç°</p>
<p>æ‰€ä»¥,java9Stringæ”¹ä¸ºè¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">String</span></span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">java</span>.io.Serializable, Comparable&lt;String&gt;, CharSequence,</span><br><span class="line">               Constable, ConstantDesc &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The value is used for character storage.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@implNote</span> This field is trusted by the VM, and is a subject to</span></span><br><span class="line"><span class="comment">     * constant folding if String instance is constant. Overwriting this</span></span><br><span class="line"><span class="comment">     * field after construction will cause problems.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Additionally, it is marked with &#123;<span class="doctag">@link</span> Stable&#125; to trust the contents</span></span><br><span class="line"><span class="comment">     * of the array. No other facility in JDK provides this functionality (yet).</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> Stable&#125; is safe here, because value is never null.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">byte</span>[] value;</span><br><span class="line">               &#125; </span><br></pre></td></tr></table></figure>

<p>java9ç¡®å®æ”¹ç”¨byteæ•°ç»„ä¿å­˜å­—ç¬¦ä¸²äº†ã€‚</p>
<p>ä»£ç ä¸­è¿™ä¸ªåœ°æ–¹å°†æ ‡è®°æ­¤å­—ç¬¦ä¸²çš„ç¼–ç æ–¹å¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">byte</span> coder; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>coderå¯ä»¥å–å€¼ä¸ºLATIN1ï¼ˆ0ï¼‰å’ŒUTF16ï¼ˆ1ï¼‰ï¼ŒLatin1æ¯ä¸ªå­—ç¬¦å ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œdebugå¯ä»¥çœ‹åˆ° :<br><img src="/string-in-java/1.webp" alt="1"></p>
<p>éasciiå­—ç¬¦ä»å°†ä½¿ç”¨UTF16ç¼–ç </p>
<p><img src="/string-in-java/2.webp" alt="2"><br>é‚£ä¹ˆè°ƒç”¨toCharè¿™ä¸ªapiæ—¶å¦‚æœæ˜¯latin1ç¼–ç å°±éœ€è¦å°†å…¶è†¨èƒ€ä¸º2å­—èŠ‚ã€‚å¦‚æœæ˜¯UTF16åˆ™éœ€è¦å°†ç›¸é‚»byteé«˜ä½ä½åˆå¹¶ä¸ºcharã€‚</p>
<p>å¯¹äºasciiå­—ç¬¦ä¸ºä¸»çš„åº”ç”¨ï¼ŒåŠ å…¥å­—ç¬¦ä¸²å‹ç¼©ç¡®å®å¯ä»¥èŠ‚çº¦ä¸å°‘å†…å­˜ï¼Œä½†æ˜¯ä¹Ÿä¼šå¼•å…¥ä¸€å®šçš„cpuæŸè€—ï¼Œç”¨æˆ·è¿™é‡Œå¯ä»¥æƒè¡¡ä¸€ä¸‹ã€‚</p>
<p>åˆ›å»ºStringæ—¶ä¼šæ ¹æ®é…ç½® -XX:-CompactStrings å†³å®šæ˜¯å¦å¼€å¯å­—ç¬¦ä¸²å‹ç¼©ã€‚</p>
<p>Stringçš„ç¼–ç æ›´å¤šçš„æ˜¯è€ƒè™‘å†…å­˜å ç”¨ï¼Œè®¿é—®æ•ˆç‡ç­‰å› ç´ ä¸‹åšå‡ºçš„æƒè¡¡ã€‚åœ¨ä¼ è¾“ï¼ŒæŒä¹…åŒ–çš„åœºæ™¯ä¸‹å°±æ˜¯å¦ä¸€å›äº‹äº†ï¼Œäº‹å®ä¸Šåœ¨è¿™äº›åœºæ™¯ä¸Šï¼Œå¤§å¤šæ•°å¼€å‘è€…ä¼šé€‰æ‹©UTF-8ï¼Œè¿™äº›åœºæ™¯ä¸‹éšæœºè®¿é—®ä¸å†æ˜¯ç”¨æˆ·è€ƒè™‘çš„å› ç´ ï¼Œå ç”¨ç©ºé—´ï¼Œå…¼å®¹æ€§å°†æ˜¯è€ƒè™‘çš„é‡ç‚¹ã€‚å…³äºUTF8å’ŒUTF16çš„äº‰è®ºï¼Œè¿™é‡Œæœ‰ä¸ªå…³äºutf8çš„æœ‰è¶£çš„å®£è¨€   <a target="_blank" rel="noopener" href="http://utf8everywhere.org/zh-cn">http://utf8everywhere.org/zh-cn</a></p>
<h1 id="å†…å­˜"><a href="#å†…å­˜" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h1><p>é‚£ä¹ˆStringä¿å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(System.identityHashCode(<span class="string">&quot;aa&quot;</span>));</span><br><span class="line">System.out.println(System.identityHashCode(<span class="string">&quot;aa&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;============&quot;</span>);</span><br><span class="line">System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;aa&quot;</span>).equals(<span class="string">&quot;aa&quot;</span>));</span><br><span class="line">System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;aa&quot;</span>)==<span class="string">&quot;aa&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;============&quot;</span>);</span><br><span class="line">System.out.println(System.identityHashCode(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;aa&quot;</span>)));</span><br><span class="line">System.out.println(System.identityHashCode(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;aa&quot;</span>).intern()));</span><br><span class="line">System.out.println(System.identityHashCode(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;aa&quot;</span>))));</span><br><span class="line">System.out.println(System.identityHashCode(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;aa&quot;</span>)).intern()));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¾“å‡º</span><br><span class="line"><span class="number">1551870003</span></span><br><span class="line"><span class="number">1551870003</span></span><br><span class="line">============</span><br><span class="line"><span class="literal">true</span></span><br><span class="line"><span class="literal">false</span></span><br><span class="line">============</span><br><span class="line"><span class="number">967765295</span></span><br><span class="line"><span class="number">1551870003</span></span><br><span class="line"><span class="number">1917513796</span></span><br><span class="line"><span class="number">1551870003</span> </span><br></pre></td></tr></table></figure>

<p>å—¯ï¼Œæˆ‘ä»¬åˆæ­¥è§‚å¯Ÿä¸Šé¢çš„å®éªŒç»“æœï¼š</p>
<p>â€œaaâ€ è¿™ä¸ªå­—ç¬¦ä¸²ä¸ç®¡åœ¨ä»£ç ä¸­å£°æ˜å¤šå°‘æ¬¡éƒ½æŒ‡å‘äº†åŒä¸€å­—ç¬¦ä¸²å¯¹è±¡ã€‚</p>
<p>new String(â€œaaâ€) å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ï¼Œä½†æ˜¯è¿™ä¸ªå¯¹è±¡ç»§æ‰¿åŸStringæ‰€æœ‰çš„å‚æ•°ï¼Œæ‰€æœ‰æ–°è€Stringçš„hashCodeç›¸åŒï¼Œequalsæ–¹æ³•ä¹Ÿä¼šè¿”å›trueï¼Œä½†æ˜¯å¦‚æœç”¨&#x3D;&#x3D;æ¯”è¾ƒçš„è¯ï¼Œå®é™…æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„oopæŒ‡é’ˆï¼Œæ‰€ä»¥&#x3D;&#x3D;æ˜¯è¿”å›falseçš„ã€‚</p>
<p>ä½†æ˜¯internæ–¹æ³•ä¼šç©¿é€ä½ å¥—çš„è¿™å±‚å¯¹è±¡ï¼Œå–å‡ºåº•å±‚çš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œè€Œä¸”å¥—å¤šå°‘å±‚éƒ½èƒ½æ­£ç¡®å–å‡ºã€‚</p>
<p>å®é™…ä¸ŠJVMå†…éƒ¨ä¼šç»´æŠ¤å¸¸é‡æ± ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„å…³ç³»</p>
<p><img src="/string-in-java/3.webp" alt="3"><br>intern åˆ™æ˜¯ç›´æ¥ä»å¸¸é‡æ± å–Stringå¯¹è±¡ Java8 HostSpotä¸­æµç¨‹å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">oop StringTable::intern(Handle string_or_null, jchar* name,</span><br><span class="line">                        <span class="type">int</span> len, TRAPS) &#123;</span><br><span class="line">  unsigned <span class="type">int</span> <span class="variable">hashValue</span> <span class="operator">=</span> hash_string(name, len);</span><br><span class="line">  <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> the_table()-&gt;hash_to_index(hashValue);</span><br><span class="line">  <span class="type">oop</span> <span class="variable">found_string</span> <span class="operator">=</span> the_table()-&gt;lookup(index, name, len, hashValue);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Found</span></span><br><span class="line">  <span class="keyword">if</span> (found_string != NULL) <span class="keyword">return</span> found_string;</span><br><span class="line"></span><br><span class="line">  debug_only(StableMemoryChecker <span class="title function_">smc</span><span class="params">(name, len * sizeof(name[<span class="number">0</span>])</span>));</span><br><span class="line">  <span class="keyword">assert</span>(!Universe::heap()-&gt;is_in_reserved(name),</span><br><span class="line">         <span class="string">&quot;proposed name of symbol must be stable&quot;</span>);</span><br><span class="line"></span><br><span class="line">  Handle string;</span><br><span class="line">  <span class="comment">// try to reuse the string if possible</span></span><br><span class="line">  <span class="keyword">if</span> (!string_or_null.is_null()) &#123;</span><br><span class="line">    string = string_or_null;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    string = java_lang_String::create_from_unicode(name, len, CHECK_NULL);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Grab the StringTable_lock before getting the_table() because it could</span></span><br><span class="line">  <span class="comment">// change at safepoint.</span></span><br><span class="line">  MutexLocker <span class="title function_">ml</span><span class="params">(StringTable_lock, THREAD)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Otherwise, add to symbol to table</span></span><br><span class="line">  <span class="keyword">return</span> the_table()-&gt;basic_add(index, string, name, len,</span><br><span class="line">                                hashValue, CHECK_NULL);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>Stringå¸¸é‡æ± æ˜¯Hashè¡¨åŠ é“¾è¡¨ã€‚åœ¨ä»£ç ä¸­é€šè¿‡ldcè¿™ä¸ªæŒ‡ä»¤ç”Ÿæˆçš„å­—ç¬¦ä¸²ä¼šå°è¯•å†™å…¥å¸¸é‡æ± ï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­åå¤ç”¨ldcæŒ‡ä»¤å£°æ˜åŒä¸€ä¸ªå­—ç¬¦ä¸²ä¼šæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ ·èƒ½æœ€å¤§ç¨‹åº¦çš„èŠ‚çº¦å†…å­˜ç©ºé—´ã€‚è€Œå¯¹äºè¿è¡Œæ—¶ç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œç”¨æˆ·ä½¿ç”¨byteæ•°ç»„å’Œç›¸åº”ç¼–ç ç”Ÿæˆçš„å¯¹è±¡åˆ™å®Œå…¨åœ¨å †é‡Œï¼Œå°†éšç€gcè¢«é‡Šæ”¾ã€‚</p>
<p>é‚£å•¥æ—¶åº”è¯¥ç”¨internå‘¢ï¼Ÿå½“ä½ éå¸¸æ˜ç¡®æŸæ®µé«˜é¢‘æ‰§è¡Œçš„ä»£ç ä¼šåå¤äº§ç”ŸStringå¯¹è±¡å´æŒ‡å‘ç›¸åŒçš„å¸¸é‡æ± å¯¹è±¡æ—¶ï¼šæ¯”å¦‚æŸäº›åºåˆ—åŒ–ï¼Œæ—¥å¿—æ¡†æ¶çš„å®ç°ã€‚</p>
<h1 id="â€œ-â€-åº”è¯¥æ€ä¹ˆç”¨ï¼Ÿ"><a href="#â€œ-â€-åº”è¯¥æ€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="â€œ+â€ åº”è¯¥æ€ä¹ˆç”¨ï¼Ÿ"></a>â€œ+â€ åº”è¯¥æ€ä¹ˆç”¨ï¼Ÿ</h1><p>Javaç¨‹åºå‘˜ç»å¸¸è¢«å‘ŠçŸ¥çš„ä¸€æ¡ä¼˜åŒ–å°±æ˜¯ï¼Œä¸è¦åœ¨å¯†é›†å¾ªç¯ä¸­ä½¿ç”¨+å·æ‹¼æ¥å­—ç¬¦ä¸²ã€‚å®é™…ä¸Š + æ‹¼æ¥æ˜¯Javacä¼šè¿›è¡Œè„±ç³–ï¼Œæ¯æ¬¡ä½¿ç”¨+å·ä¼šäº§ç”Ÿä¸€ä¸ªå…¨æ–°çš„StringBuilderå¯¹è±¡ï¼Œç¼–è¯‘å™¨æ— æ³•æ›¿ç”¨æˆ·å°†StringBuilderæåˆ°å¾ªç¯å¤–ï¼Œç”¨æˆ·æ‰‹åŠ¨åˆ›å»ºStringBuilderåœ¨å¾ªç¯ä¸­appendæ•ˆç‡ä¼šé«˜å¾ˆå¤šã€‚</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>fenix
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://fenixc9.github.io/string-in-java/" title="æ·±å…¥ç†è§£Javaçš„å­—ç¬¦ä¸²">https://fenixc9.github.io/string-in-java/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag"># æ•°æ®ç»“æ„</a>
              <a href="/tags/Java/" rel="tag"># Java</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/directory-tree-in-rust/" rel="prev" title="Rustå®ç°çš„æ–‡ä»¶ç›®å½•æ ‘">
      <i class="fa fa-chevron-left"></i> Rustå®ç°çš„æ–‡ä»¶ç›®å½•æ ‘
    </a></div>
      <div class="post-nav-item">
    <a href="/ebpf-in-rust-1/" rel="next" title="ç”¨Rustç©eBPF â€”â€” RedBpf">
      ç”¨Rustç©eBPF â€”â€” RedBpf <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BC%96%E7%A0%81"><span class="nav-number">1.</span> <span class="nav-text">ç¼–ç </span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%86%85%E5%AD%98"><span class="nav-number">2.</span> <span class="nav-text">å†…å­˜</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E2%80%9C-%E2%80%9D-%E5%BA%94%E8%AF%A5%E6%80%8E%E4%B9%88%E7%94%A8%EF%BC%9F"><span class="nav-number">3.</span> <span class="nav-text">â€œ+â€ åº”è¯¥æ€ä¹ˆç”¨ï¼Ÿ</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fenix"
      src="/images/a.jpeg">
  <p class="site-author-name" itemprop="name">fenix</p>
  <div class="site-description" itemprop="description">ç¨‹åºå‘˜ï¼Œæ— å¯æ•‘è¯çš„ç†æƒ³ä¸»ä¹‰è€…</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">64</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fenixc9" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;fenixc9" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2020 â€“ 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fenix</span>
</div>

    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.8.0/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://cdn.staticfile.org/gitalk/1.8.0/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'd02b822b1f8e730490ab',
      clientSecret: '6e5b6fb476f3b8735a09beeb43bdbc5f160c9849',
      repo        : 'blog_comment',
      owner       : 'fenixc9',
      admin       : ['fenixc9'],
      id          : 'd3ce8370192306fab8e423bda3913e76',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
